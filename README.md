````markdown
# Shai-Hulud 2.0 Detection Tools

–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ (IOC) –∞—Ç–∞–∫–∏ Shai-Hulud 2.0 - —Å–∞–º–æ—Ä–µ–ø–ª–∏—Ü–∏—Ä—É—é—â–µ–≥–æ—Å—è —á–µ—Ä–≤—è, –∞—Ç–∞–∫—É—é—â–µ–≥–æ npm —ç–∫–æ—Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑ supply chain.

[![Python 3.7+](https://img.shields.io/badge/python-3.7+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![No Dependencies](https://img.shields.io/badge/dependencies-none-green.svg)](https://github.com/Krakazybik/shai-hulud-2.0-detection)

## ÔøΩ –û –∞—Ç–∞–∫–µ

**Shai-Hulud 2.0** - —ç—Ç–æ —Å–∞–º–æ—Ä–µ–ø–ª–∏—Ü–∏—Ä—É—é—â–∏–π—Å—è —á–µ—Ä–≤—å, –∫–æ—Ç–æ—Ä—ã–π:

- ü¶† –ö–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç npm –ø–∞–∫–µ—Ç—ã —á–µ—Ä–µ–∑ preinstall/postinstall —Å–∫—Ä–∏–ø—Ç—ã
- üîë –ö—Ä–∞–¥—ë—Ç credentials (GitHub, NPM, AWS, GCP, Azure, Datadog)
- üåê –≠–∫—Å—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º "Sha1-Hulud: The Second Coming"
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ npm publish
- üí£ –ò–º–µ–µ—Ç –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é —É–¥–∞–ª–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- ü§ñ –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –º–∞—à–∏–Ω—É –∫–∞–∫ GitHub self-hosted runner (SHA1HULUD)
- üïµÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç TruffleHog –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚è±Ô∏è –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç CI –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ/–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ú–∞—Å—à—Ç–∞–± –∞—Ç–∞–∫–∏

- **25,000+** —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- **795+** –∑–∞—Ä–∞–∂—ë–Ω–Ω—ã—Ö npm –ø–∞–∫–µ—Ç–æ–≤ (–ø–æ –¥–∞–Ω–Ω—ã–º Datadog IOCs)
- **132+ –º–∏–ª–ª–∏–æ–Ω–∞** –∑–∞–≥—Ä—É–∑–æ–∫ –≤ –º–µ—Å—è—Ü —É —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –æ—Ç Zapier, PostHog, Postman, ENS Domains, AsyncAPI, Browserbase

---

## ‚ö° –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

**–û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç - —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**

```bash
git clone https://github.com/Krakazybik/shai-hulud-2.0-detection.git /tmp/shai-hulud-scanner && \
python3 /tmp/shai-hulud-scanner/shai_hulud_scanner.py . --update-iocs && \
rm -rf /tmp/shai-hulud-scanner
```

**–° —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º JSON –æ—Ç—á—ë—Ç–∞:**

```bash
git clone https://github.com/Krakazybik/shai-hulud-2.0-detection.git /tmp/shai-hulud-scanner && \
python3 /tmp/shai-hulud-scanner/shai_hulud_scanner.py . \
  --update-iocs \
  --json-report shai-hulud-report.json && \
echo "üìÑ –û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ shai-hulud-report.json" && \
rm -rf /tmp/shai-hulud-scanner
```

**–†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**

```bash
git clone https://github.com/Krakazybik/shai-hulud-2.0-detection.git /tmp/shai-hulud-scanner && \
python3 /tmp/shai-hulud-scanner/shai_hulud_scanner.py ~/projects \
  --recursive \
  --update-iocs \
  --json-report scan-results.json && \
rm -rf /tmp/shai-hulud-scanner
```

**–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:**

```bash
git clone https://github.com/Krakazybik/shai-hulud-2.0-detection.git && \
cd shai-hulud-2.0-detection && \
./install.sh && \
python3 shai_hulud_scanner.py .
```

> **üí° –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –¢–æ–ª—å–∫–æ Python 3.7+ - –Ω–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π!  
> **üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ:** –°–∫–∞–Ω–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python

---

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### üî¥ –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫–∞–Ω–µ—Ä: `shai_hulud_scanner.py`

**–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Å–∫–∞–Ω–µ—Ä —Å –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¢–û–õ–¨–ö–û –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python 3.7+

#### ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

**üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
- ‚úÖ **795+ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤** –∏–∑ [Datadog IOCs](https://github.com/DataDog/indicators-of-compromise/tree/main/shai-hulud-2.0)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã IOCs –∏–∑ GitHub
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `package.json`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `package-lock.json` (npm v1/v2/v3)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `yarn.lock`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `pnpm-lock.yaml` (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä, –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**üîç –ì–ª—É–±–æ–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (16 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤):**
- üî¥ –ö—Ä–∞–∂–∞ credentials (Git, NPM, AWS, GCP, Azure, Datadog)
- üî¥ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TruffleHog –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
- üî¥ GitHub API —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- üî¥ Instance Metadata Service –¥–æ—Å—Ç—É–ø
- üî¥ –°–æ–∑–¥–∞–Ω–∏–µ IOC —Ñ–∞–π–ª–æ–≤ (`cloud.json`, `truffleSecrets.json`, etc.)
- üî¥ –î–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (—É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
- üî¥ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è GitHub self-hosted runners
- üü† Double base64 encoding
- üü° Environment variable scraping
- üü° CI detection patterns

**‚öôÔ∏è GitHub Actions Workflows:**
- üî¥ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ `discussion.yaml` (command injection backdoor)
- üî¥ –ü–æ–∏—Å–∫ `formatter_*.yml` (secrets exfiltration)
- üî¥ Self-hosted runner workflows
- üî¥ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã Shai-Hulud –≤ workflows

**üìä –û—Ç—á—ë—Ç–Ω–æ—Å—Ç—å:**
- üìà –ö—Ä–∞—Å–∏–≤—ã–π –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π
- üìÑ JSON –æ—Ç—á—ë—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- üéØ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ severity (CRITICAL, HIGH, WARNING)
- üìã –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–π –Ω–∞—Ö–æ–¥–∫–µ
- üí° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é

#### üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
./install.sh

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
python3 shai_hulud_scanner.py ./my-project

# –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
python3 shai_hulud_scanner.py ~/projects --recursive

# –ë—ã—Å—Ç—Ä–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
python3 shai_hulud_scanner.py . --quick

# –° –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º IOCs –∏ JSON –æ—Ç—á—ë—Ç–æ–º
python3 shai_hulud_scanner.py . --update-iocs --json-report report.json

# –°–ø—Ä–∞–≤–∫–∞
python3 shai_hulud_scanner.py --help
```

#### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python 3.7+** (—Ç–æ–ª—å–∫–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏!)
- –ù–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Linux, macOS, Windows

---

### 2. Semgrep Rules (`shai-hulud-2.0-detection.yaml`)

–ù–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ Shai-Hulud 2.0. –î–æ–ø–æ–ª–Ω—è–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫–∞–Ω–µ—Ä.

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Semgrep

```bash
# –ß–µ—Ä–µ–∑ pip
pip install semgrep

# –ß–µ—Ä–µ–∑ Homebrew (macOS)
brew install semgrep

# –ß–µ—Ä–µ–∑ npm
npm install -g @semgrep/cli
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
semgrep --config shai-hulud-2.0-detection.yaml .

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
semgrep --config shai-hulud-2.0-detection.yaml /path/to/project

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤—ã–≤–æ–¥–æ–º –≤ JSON
semgrep --config shai-hulud-2.0-detection.yaml --json -o report.json .

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
semgrep --config shai-hulud-2.0-detection.yaml --severity ERROR .
```

#### –ß—Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç

- ‚úÖ Malicious —Ñ–∞–π–ª—ã: `setup_bun.js`, `bun_environment.js`
- ‚úÖ –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ preinstall/postinstall —Å–∫—Ä–∏–ø—Ç—ã
- ‚úÖ –ö—Ä–∞–∂—É credentials (GitHub, NPM, AWS, GCP, Azure)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TruffleHog –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ –≠–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ GitHub API
- ‚úÖ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º "Sha1-Hulud: The Second Coming"
- ‚úÖ GitHub self-hosted runner "SHA1HULUD"
- ‚úÖ Malicious workflow —Ñ–∞–π–ª—ã
- ‚úÖ –î–æ—Å—Ç—É–ø –∫ Instance Metadata Service
- ‚úÖ –î–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (—É–¥–∞–ª–µ–Ω–∏–µ home directory)
- ‚úÖ Double base64 encoding
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É Bun runtime
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π npm publish

---

### 3. Legacy Scanner (v2)

–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:

**`shai_hulud_scanner_v2.py`:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ lock —Ñ–∞–π–ª–æ–≤ (npm, yarn, pnpm)
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å

**‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `shai_hulud_scanner.py` (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫–∞–Ω–µ—Ä) –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã.

---

## üóÇÔ∏è –ë–∞–∑–∞ IOCs

–°–∫–∞–Ω–Ω–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –±–∞–∑—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

- **Datadog Security Labs** - 795+ –ø–∞–∫–µ—Ç–æ–≤
- Wiz Research
- SafeDep
- Helixguard, Koi, ReversingLabs
- SocketDev, StepSecurity

### –ü—Ä–∏–º–µ—Ä—ã —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

| –ü–∞–∫–µ—Ç | –í–µ—Ä—Å–∏–∏ | –ò—Å—Ç–æ—á–Ω–∏–∫–∏ |
|-------|--------|-----------|
| `zapier-platform-core` | 18.0.2, 18.0.3, 18.0.4 | Datadog, Wiz, ReversingLabs |
| `posthog-node` | 4.18.1, 5.11.3, 5.13.3 | Datadog, HelixGuard, Koi |
| `@ensdomains/ensjs` | 4.0.3 | Datadog, ReversingLabs |
| `@postman/postman-mcp-cli` | 1.0.3, 1.0.4, 1.0.5 | Datadog, Wiz, StepSecurity |
| `@browserbasehq/stagehand` | 3.0.4 | Datadog, SocketDev |
| `@asyncapi/*` | 30+ –ø–∞–∫–µ—Ç–æ–≤ | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ |

**–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫:** `consolidated_iocs.csv` (795+ –ø–∞–∫–µ—Ç–æ–≤)

---

## üìä CI/CD Integration

### GitHub Actions

```yaml
name: Shai-Hulud 2.0 Security Scan
on: [push, pull_request]

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: Clone Shai-Hulud Scanner
        run: |
          git clone https://github.com/Krakazybik/shai-hulud-2.0-detection.git /tmp/scanner
      
      - name: Run Shai-Hulud Scanner
        run: |
          python3 /tmp/scanner/shai_hulud_scanner.py . \
            --update-iocs \
            --json-report scan-report.json
      
      - name: Upload scan report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: shai-hulud-scan-report
          path: scan-report.json
      
      # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: Semgrep –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
      - name: Install Semgrep
        run: pip install semgrep
      
      - name: Run Semgrep scan
        run: |
          semgrep --config /tmp/scanner/shai-hulud-2.0-detection.yaml \
                  --severity ERROR \
                  --error \
                  .
```

### GitLab CI

```yaml
shai-hulud-scan:
  image: python:3.11
  script:
    # –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–∞–Ω–µ—Ä–∞
    - git clone https://github.com/Krakazybik/shai-hulud-2.0-detection.git /tmp/scanner
    
    # –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Python —Å–∫–∞–Ω–µ—Ä–æ–º
    - python3 /tmp/scanner/shai_hulud_scanner.py . --update-iocs --json-report report.json
    
    # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: Semgrep
    - pip install semgrep
    - semgrep --config /tmp/scanner/shai-hulud-2.0-detection.yaml --error .
  artifacts:
    reports:
      sast: report.json
    paths:
      - report.json
    when: always
  only:
    - merge_requests
    - main

# –ë—ã—Å—Ç—Ä–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è feature –≤–µ—Ç–æ–∫
quick-scan:
  image: python:3.11
  script:
    - git clone https://github.com/Krakazybik/shai-hulud-2.0-detection.git /tmp/scanner
    - python3 /tmp/scanner/shai_hulud_scanner.py . --quick
  only:
    - branches
  except:
    - main
```

### Jenkins Pipeline

```groovy
pipeline {
    agent any
    
    stages {
        stage('Clone Scanner') {
            steps {
                sh 'git clone https://github.com/Krakazybik/shai-hulud-2.0-detection.git /tmp/scanner'
            }
        }
        
        stage('Shai-Hulud Scan') {
            steps {
                sh '''
                    python3 /tmp/scanner/shai_hulud_scanner.py . \
                        --update-iocs \
                        --json-report scan-report.json
                '''
            }
        }
    }
    
    post {
        always {
            archiveArtifacts artifacts: 'scan-report.json', allowEmptyArchive: true
        }
        cleanup {
            sh 'rm -rf /tmp/scanner'
        }
    }
}
```

### CircleCI

```yaml
version: 2.1

jobs:
  shai-hulud-scan:
    docker:
      - image: python:3.11
    steps:
      - checkout
      
      - run:
          name: Clone Scanner
          command: git clone https://github.com/Krakazybik/shai-hulud-2.0-detection.git /tmp/scanner
      
      - run:
          name: Run Shai-Hulud Scanner
          command: |
            python3 /tmp/scanner/shai_hulud_scanner.py . \
              --update-iocs \
              --json-report scan-report.json
      
      - store_artifacts:
          path: scan-report.json
          destination: shai-hulud-report

workflows:
  version: 2
  security-scan:
    jobs:
      - shai-hulud-scan
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤–∫–ª—é—á–∞–µ—Ç –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å–∫–∞–Ω–µ—Ä–∞:

```bash
# –¢–µ—Å—Ç –Ω–∞ —á–∏—Å—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ (–¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏)
python3 shai_hulud_scanner.py test-samples/clean-test/

# –¢–µ—Å—Ç –Ω–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö (–¥–æ–ª–∂–µ–Ω –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —É–≥—Ä–æ–∑—ã)
python3 shai_hulud_scanner.py test-samples/malicious/

# –¢–µ—Å—Ç –Ω–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö
python3 shai_hulud_scanner.py test-samples/malicious/test-package-compromised-zapier/

# –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
python3 shai_hulud_scanner.py test-samples/ --recursive
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
test-samples/
‚îú‚îÄ‚îÄ clean/              # –ß–∏—Å—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã (–ª–µ–≥–∏—Ç–∏–º–Ω—ã–π –∫–æ–¥)
‚îú‚îÄ‚îÄ clean-test/         # –¢–µ—Å—Ç–æ–≤—ã–π —á–∏—Å—Ç—ã–π –ø—Ä–æ–µ–∫—Ç
‚îú‚îÄ‚îÄ malicious/          # –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ credential-theft.js
‚îÇ   ‚îú‚îÄ‚îÄ environment-scraping.js
‚îÇ   ‚îú‚îÄ‚îÄ ioc-files.js
‚îÇ   ‚îú‚îÄ‚îÄ github-exfiltration.js
‚îÇ   ‚îî‚îÄ‚îÄ test-package-*/  # –°–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
‚îî‚îÄ‚îÄ workflows/          # –ü—Ä–∏–º–µ—Ä—ã –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö workflows
```

## üîó –°—Å—ã–ª–∫–∏ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∞—Ç–∞–∫–∏
- [Datadog Security Labs - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑](https://securitylabs.datadoghq.com/articles/shai-hulud-2.0-npm-worm/)
- [Wiz Research - IOCs –∏ –¥–µ—Ç–∞–ª–∏](https://www.wiz.io/blog/shai-hulud-2-0-ongoing-supply-chain-attack)
- [SafeDep - Incident Report](https://safedep.io/shai-hulud-second-coming-supply-chain-attack/)
- [Aikido Security - –ê–Ω–∞–ª–∏–∑ Zapier/ENS](https://www.aikido.dev/blog/shai-hulud-strikes-again-hitting-zapier-ensdomains)
- [Palo Alto Unit 42 - Supply Chain Attack](https://unit42.paloaltonetworks.com/npm-supply-chain-attack/)

### –ë–∞–∑—ã IOCs
- [Datadog IOCs (GitHub)](https://github.com/DataDog/indicators-of-compromise/tree/main/shai-hulud-2.0) - **–û—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞**
- [Wiz IOCs GitHub](https://github.com/wiz-sec-public/wiz-research-iocs)
- [SafeDep Migration Response](https://github.com/safedep/shai-hulud-migration-response)

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- [Socket Security](https://socket.dev/blog) - Continuous monitoring
- [Datadog Supply Chain Security](https://www.datadoghq.com/product/software-delivery/supply-chain-security/)
- [GitHub Dependabot](https://docs.github.com/en/code-security/dependabot)
- [Snyk](https://snyk.io/)

---

## ü§ù –£—á–∞—Å—Ç–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ

–°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π –∏ pull requests –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature –≤–µ—Ç–∫—É (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã IOCs

–ï—Å–ª–∏ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ –Ω–æ–≤—ã–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:
1. –î–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ `consolidated_iocs.csv`
2. –û–±–Ω–æ–≤–∏—Ç–µ —Ç–µ—Å—Ç—ã –≤ `test-samples/`
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ PR —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

## ‚ö†Ô∏è Disclaimer

–≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å" –¥–ª—è –ø–æ–º–æ—â–∏ –≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ Shai-Hulud 2.0. –û–Ω–∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç 100% –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∞—Ç–∞–∫–∏. 

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å:**
- Code review –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- Dependency scanning tools
- Runtime monitoring
- Security awareness training
- MFA –Ω–∞ –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–∞—Ö
- Principle of least privilege

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

–°–º. [LICENSE](LICENSE) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **795+** —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –≤ –±–∞–∑–µ IOCs
- **16** –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞
- **0** –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **100%** –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ:** 2025  
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç–∏–≤–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** November 26, 2025  
**–°—Ç–∞—Ç—É—Å —É–≥—Ä–æ–∑—ã:** üî¥ –ê–ö–¢–ò–í–ù–ê - –Ω–æ–≤—ã–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ

**‚ö° –ó–∞—â–∏—Ç–∏—Ç–µ —Å–≤–æ—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!**

````

### –û—á–∏—Å—Ç–∫–∞

```bash
# –£–¥–∞–ª–∏—Ç–µ node_modules –∏ lock —Ñ–∞–π–ª—ã
rm -rf node_modules package-lock.json yarn.lock

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —á–∏—Å—Ç—ã–µ –≤–µ—Ä—Å–∏–∏
npm install

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ package.json –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git diff package.json
```

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –º–µ—Ä—ã

1. **–í–∫–ª—é—á–∏—Ç–µ MFA** –Ω–∞ GitHub –∏ NPM (WebAuthn/FIDO2)
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ npm provenance** –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤
3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ lifecycle —Å–∫—Ä–∏–ø—Ç—ã** –≤ CI/CD:
   ```bash
   npm install --ignore-scripts
   ```
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ dependencies** —Å –ø–æ–º–æ—â—å—é:
   - GitHub Dependabot
   - Snyk
   - Socket Security
   - Datadog Supply Chain Security Firewall

---

3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ PR —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

---

- Principle of least privilege

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** November 2025  
**–°—Ç–∞—Ç—É—Å —É–≥—Ä–æ–∑—ã:** –ê–ö–¢–ò–í–ù–ê - –Ω–æ–≤—ã–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ
