# Shai-Hulud 2.0 Detection Tools

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ (IOC) –∞—Ç–∞–∫–∏ Shai-Hulud 2.0 - –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π supply chain –∞—Ç–∞–∫–∏ –Ω–∞ npm —ç–∫–æ—Å–∏—Å—Ç–µ–º—É.

## üìã –û –∞—Ç–∞–∫–µ

**Shai-Hulud 2.0** - —ç—Ç–æ —Å–∞–º–æ—Ä–µ–ø–ª–∏—Ü–∏—Ä—É—é—â–∏–π—Å—è —á–µ—Ä–≤—å, –∫–æ—Ç–æ—Ä—ã–π:

- ü¶† –ö–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç npm –ø–∞–∫–µ—Ç—ã —á–µ—Ä–µ–∑ preinstall —Å–∫—Ä–∏–ø—Ç—ã
- üîë –ö—Ä–∞–¥—ë—Ç credentials (GitHub, NPM, AWS, GCP, Azure, Datadog)
- üåê –≠–∫—Å—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º "Sha1-Hulud: The Second Coming"
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ npm publish
- üí£ –ò–º–µ–µ—Ç –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é —É–¥–∞–ª–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- ü§ñ –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –º–∞—à–∏–Ω—É –∫–∞–∫ GitHub self-hosted runner (SHA1HULUD)

### –ú–∞—Å—à—Ç–∞–± –∞—Ç–∞–∫–∏

- **25,000+** —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- **800+** –∑–∞—Ä–∞–∂—ë–Ω–Ω—ã—Ö npm –ø–∞–∫–µ—Ç–æ–≤
- **132 –º–∏–ª–ª–∏–æ–Ω–∞** –∑–∞–≥—Ä—É–∑–æ–∫ –≤ –º–µ—Å—è—Ü —É —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –æ—Ç Zapier, PostHog, Postman, ENS Domains, AsyncAPI

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### 1. Semgrep Rules (`shai-hulud-2.0-detection.yaml`)

–ù–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ Shai-Hulud 2.0.

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Semgrep

```bash
# –ß–µ—Ä–µ–∑ pip
pip install semgrep

# –ß–µ—Ä–µ–∑ Homebrew (macOS)
brew install semgrep

# –ß–µ—Ä–µ–∑ npm
npm install -g @semgrep/cli
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
semgrep --config shai-hulud-2.0-detection.yaml .

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
semgrep --config shai-hulud-2.0-detection.yaml /path/to/project

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤—ã–≤–æ–¥–æ–º –≤ JSON
semgrep --config shai-hulud-2.0-detection.yaml --json -o report.json .

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
semgrep --config shai-hulud-2.0-detection.yaml --severity ERROR .
```

#### –ß—Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç

- ‚úÖ Malicious —Ñ–∞–π–ª—ã: `setup_bun.js`, `bun_environment.js`
- ‚úÖ –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ preinstall/postinstall —Å–∫—Ä–∏–ø—Ç—ã
- ‚úÖ –ö—Ä–∞–∂—É credentials (GitHub, NPM, AWS, GCP, Azure)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TruffleHog –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ –≠–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ GitHub API
- ‚úÖ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º "Sha1-Hulud: The Second Coming"
- ‚úÖ GitHub self-hosted runner "SHA1HULUD"
- ‚úÖ Malicious workflow —Ñ–∞–π–ª—ã
- ‚úÖ –î–æ—Å—Ç—É–ø –∫ Instance Metadata Service
- ‚úÖ –î–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (—É–¥–∞–ª–µ–Ω–∏–µ home directory)
- ‚úÖ Double base64 encoding
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É Bun runtime
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π npm publish

### 2. Package Scanner (`shai_hulud_scanner.py`)

Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ `package.json` –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤.

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
python3 -m pip install --upgrade pip
# –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Python
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ package.json
python3 shai_hulud_scanner.py ./package.json

# –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
python3 shai_hulud_scanner.py ./projects

# –ß–µ—Ä–µ–∑ shebang (–µ—Å–ª–∏ —Å–¥–µ–ª–∞–Ω chmod +x)
./shai_hulud_scanner.py ./package.json
```

#### –ß—Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç

- ‚úÖ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –∏ –≤–µ—Ä—Å–∏–∏
- ‚úÖ Malicious –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö
- ‚úÖ –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ lifecycle —Å–∫—Ä–∏–ø—Ç—ã (preinstall, postinstall)
- ‚úÖ –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (curl, wget, bun)
- ‚úÖ –°—Å—ã–ª–∫–∏ –Ω–∞ malicious —Ñ–∞–π–ª—ã
- ‚úÖ –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

#### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã

- `zapier-platform-core@0.15.x`
- `zapier-platform-cli@18.0.x`
- `zapier-sdk@1.0.0`
- `@asyncapi/specs@7.6.4`
- `posthog-node@4.2.1`
- `@postman/postman-mcp-cli@0.1.0`
- `@ensdomains/ensjs@4.1.0`
- –ò –¥—Ä—É–≥–∏–µ...

## üö® –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

1. **–ò–∑–æ–ª–∏—Ä—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É**
   - –û—Ç–∫–ª—é—á–∏—Ç–µ –æ—Ç —Å–µ—Ç–∏ –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
   - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ CI/CD –ø–∞–π–ø–ª–∞–π–Ω—ã

2. **–†–æ—Ç–∞—Ü–∏—è credentials**
   ```bash
   # GitHub tokens
   # –ü–µ—Ä–µ–π–¥–∏—Ç–µ: Settings ‚Üí Developer settings ‚Üí Personal access tokens ‚Üí Revoke all
   
   # NPM tokens
   npm token revoke --all
   
   # AWS credentials
   aws iam delete-access-key --access-key-id <KEY_ID>
   
   # GCP credentials
   gcloud auth revoke --all
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏**
   ```bash
   # –ü–æ–∏—Å–∫ –≤ GitHub
   # https://github.com/search?q=Sha1-Hulud%3A+The+Second+Coming&type=repositories
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub Actions runners**
   ```bash
   # Settings ‚Üí Actions ‚Üí Runners
   # –ù–∞–π–¥–∏—Ç–µ –∏ —É–¥–∞–ª–∏—Ç–µ runner —Å –∏–º–µ–Ω–µ–º "SHA1HULUD"
   ```

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ workflows**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .github/workflows/discussion.yaml
   find . -name "discussion.yaml" -path "*/.github/workflows/*"
   ```

### –û—á–∏—Å—Ç–∫–∞

```bash
# –£–¥–∞–ª–∏—Ç–µ node_modules –∏ lock —Ñ–∞–π–ª—ã
rm -rf node_modules package-lock.json yarn.lock

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —á–∏—Å—Ç—ã–µ –≤–µ—Ä—Å–∏–∏
npm install

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ package.json –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git diff package.json
```

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –º–µ—Ä—ã

1. **–í–∫–ª—é—á–∏—Ç–µ MFA** –Ω–∞ GitHub –∏ NPM (WebAuthn/FIDO2)
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ npm provenance** –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤
3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ lifecycle —Å–∫—Ä–∏–ø—Ç—ã** –≤ CI/CD:
   ```bash
   npm install --ignore-scripts
   ```
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ dependencies** —Å –ø–æ–º–æ—â—å—é:
   - GitHub Dependabot
   - Snyk
   - Socket Security
   - Datadog Supply Chain Security Firewall

## üìä CI/CD Integration

### GitHub Actions

```yaml
name: Shai-Hulud Detection
on: [push, pull_request]

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Install Semgrep
        run: pip install semgrep
      
      - name: Run Semgrep scan
        run: |
          semgrep --config shai-hulud-2.0-detection.yaml \
                  --severity ERROR \
                  --error \
                  .
      
      - name: Scan package.json
        run: python3 shai_hulud_scanner.py .
```

### GitLab CI

```yaml
shai-hulud-scan:
  image: python:3.11
  script:
    - pip install semgrep
    - semgrep --config shai-hulud-2.0-detection.yaml --error .
    - python3 shai_hulud_scanner.py .
  only:
    - merge_requests
    - main
```

## üîó –°—Å—ã–ª–∫–∏ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

- [Datadog Security Labs Analysis](https://securitylabs.datadoghq.com/articles/shai-hulud-2.0-npm-worm/)
- [Wiz Research IOCs](https://www.wiz.io/blog/shai-hulud-2-0-ongoing-supply-chain-attack)
- [SafeDep Incident Report](https://safedep.io/shai-hulud-second-coming-supply-chain-attack/)
- [Aikido Security Blog](https://www.aikido.dev/blog/shai-hulud-strikes-again-hitting-zapier-ensdomains)
- [Palo Alto Unit 42](https://unit42.paloaltonetworks.com/npm-supply-chain-attack/)

## üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª

–°–ø–∏—Å–æ–∫ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è. –°–ª–µ–¥–∏—Ç–µ –∑–∞:

- [Wiz IOCs GitHub](https://github.com/wiz-sec-public/wiz-research-iocs)
- [SafeDep Migration Response](https://github.com/safedep/shai-hulud-migration-response)
- [Socket Security Blog](https://socket.dev/blog)

## ‚ö†Ô∏è Disclaimer

–≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å" –¥–ª—è –ø–æ–º–æ—â–∏ –≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ Shai-Hulud 2.0. –û–Ω–∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç 100% –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∞—Ç–∞–∫–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ security –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏.

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** November 2025  
**–°—Ç–∞—Ç—É—Å —É–≥—Ä–æ–∑—ã:** –ê–ö–¢–ò–í–ù–ê - –Ω–æ–≤—ã–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ
